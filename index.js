!function s(r,a,l){function c(e,t){if(!a[e]){if(!r[e]){var n="function"==typeof require&&require;if(!t&&n)return n(e,!0);if(u)return u(e,!0);var o=new Error("Cannot find module '"+e+"'");throw o.code="MODULE_NOT_FOUND",o}var i=a[e]={exports:{}};r[e][0].call(i.exports,function(t){return c(r[e][1][t]||t)},i,i.exports,s,r,a,l)}return a[e].exports}for(var u="function"==typeof require&&require,t=0;t<l.length;t++)c(l[t]);return c}({1:[function(t,e,n){var o,i;o=this,i=function(){"use strict";function e(t){return(e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}return function(t,e,n,o,i,s,r,a,l,c){"boolean"!=typeof r&&(a,a=r,r=!1);var u,d="function"==typeof n?n.options:n;if(t.render&&(d.render=t.render,d.staticRenderFns=t.staticRenderFns,d._compiled=!0),u)if(d.functional){var f=d.render;d.render=function(t,e){return u.call(e),f(t,e)}}else{var p=d.beforeCreate;d.beforeCreate=p?[].concat(p,u):[u]}return n}({render:function(){var i=this,t=i.$createElement,s=i._self._c||t;return s("section",{staticClass:"k-tbl"},[s("header",{staticClass:"k-section-header"},[s("k-headline",[i._v(i._s(i.headline))]),i._v(" "),i._t("filter",[s("k-button-group",[s("k-button",{attrs:{disbaled:!0,icon:"cirle"}}),i._v(" "),i.showReset?s("button",{staticClass:"k-tbl-reset",on:{click:i.reset}},[i._v("\n          "+i._s(i.config.labels.reset)+"\n        ")]):i._e(),i._v(" "),i.showSearch?s("input",{directives:[{name:"model",rawName:"v-model",value:i.searchTerm,expression:"searchTerm"}],ref:"search",staticClass:"k-tbl-search",attrs:{type:"text",placeholder:i.config.labels.filter},domProps:{value:i.searchTerm},on:{keydown:function(t){return!t.type.indexOf("key")&&i._k(t.keyCode,"esc",27,t.key,["Esc","Escape"])?null:i.reset(t)},input:function(t){t.target.composing||(i.searchTerm=t.target.value)}}}):i._e(),i._v(" "),i.showAdd?s("k-button",{attrs:{icon:"add"},on:{click:function(t){return i.$emit("add")}}},[i._v("\n          "+i._s(i.$t("add"))+"\n        ")]):i._e()],1)])],2),i._v(" "),i._t("table",[s("table",[s("thead",[0===i.rowsFiltered.length?s("th",{attrs:{colspan:i.widthLoading}}):[i._l(i.columns,function(e){return s("th",{key:e.field,class:"head-"+e.class,attrs:{"data-align":i.getAlign(e),"data-width":e.width,"data-responsive":!1!==e.responsive,"data-sortable":i.config.sort.enabled&&!1!==e.sort,"data-sorted":i.sortBy===e&&(1===i.sortOrder?"asc":"desc")},on:{click:function(t){return i.setSort(e)}}},[i._v("\n            "+i._s(e.label)+"\n          ")])}),i._v(" "),i.showActions?s("th",{attrs:{"data-width":i.widthActions}}):i._e()]],2),i._v(" "),s("tbody",[0===i.rowsFiltered.length?s("tr",[s("td",{attrs:{colspan:i.widthLoading,"data-align":"center"}},[i._t("empty-row",[s("p",[this.isLoading?s("k-icon",{attrs:{type:"loader"}}):s("span",[i._v(i._s(i.config.labels.empty))])],1)])],2)]):i._l(i.rowsPaginated,function(n,o){return s("tr",{key:"row_"+o},[i._l(i.columns,function(e){return s("td",{key:e.field,class:"row-"+e.class,attrs:{"data-width":e.width,"data-align":i.getAlign(e),"data-responsive":!1!==e.responsive},on:{click:function(t){return i.$emit("action",[i.config.actions.onRow,n,e.field])}}},[i._t("column-"+(e.name||e.field),[i._t("column-$default",["url"===e.type?s("k-url-field-preview",{attrs:{value:n[e.field]}}):s("p",{domProps:{innerHTML:i._s(i.getValue(n[e.field],e.type))}})],{index:o,column:e,field:e.field,row:n,value:i.getValue(n[e.field],e.type)})],{index:o,column:e,field:e.field,row:n,value:i.getValue(n[e.field],e.type)})],2)}),i._v(" "),i.showActions?s("td",{staticClass:"k-tbl-options",attrs:{"data-width":i.widthActions,"data-align":"center"}},[i._t("column-$actions",[i.config.actions.inline?i._l(i.config.actions.items,function(e){return s("k-button",{key:e.click,attrs:{tooltip:e.text,icon:e.icon},on:{click:function(t){return t.stopPropagation(),i.$emit("action",[e.click,n])}}})}):[s("k-button",{attrs:{tooltip:i.$t("options"),icon:"dots"},on:{click:function(t){t.stopPropagation(),i.$refs["options-"+o][0].toggle()}}}),i._v(" "),s("k-dropdown-content",{ref:"options-"+o,refInFor:!0,attrs:{options:i.config.actions.items,align:"right"},on:{action:function(t){return i.$emit("action",[t,n])}}})]],{row:n,index:o})],2):i._e()],2)})],2)])]),i._v(" "),s("footer",{staticClass:"k-tbl-footer"},[i._t("footer",[0<i.rowsFiltered.length?[s("div",{staticClass:"k-tbl-perPage"},[i._t("footer-before-perPage"),i._v(" "),s("span",[i._v(i._s(i.config.labels.perPage))]),i._v(" "),s("select",{directives:[{name:"model",rawName:"v-model",value:i.perPage,expression:"perPage"}],attrs:{autocomplete:"off"},on:{input:i.onPerPage,change:function(t){var e=Array.prototype.filter.call(t.target.options,function(t){return t.selected}).map(function(t){return"_value"in t?t._value:t.value});i.perPage=t.target.multiple?e:e[0]}}},[i._l(i.config.pagination.perPageOptions,function(t){return s("option",{key:t,domProps:{value:t,textContent:i._s(t)}})}),i._v(" "),s("option",{domProps:{value:this.rowsFiltered.length}},[i._v("\n              "+i._s(i.config.labels.all)+"\n            ")])],2),i._v(" "),i._t("footer-after-perPage")],2),i._v(" "),i._t("footer-center"),i._v(" "),s("div",{staticClass:"k-tbl-navigation"},[i._t("footer-before-pagination"),i._v(" "),s("div",{staticClass:"btn btn-prev",attrs:{"data-disabled":i.page<=1},on:{click:function(t){return i.navigate(-1)}}},[s("span",{staticClass:"chevron"}),i._v(" "),s("span",[i._v(i._s(i.$t("prev")))])]),i._v(" "),s("div",{staticClass:"info"},[i._v("\n            "+i._s(this.pageRowFirst)+" - "+i._s(Math.min(this.pageRowLast,this.rowsFiltered.length))+" of "+i._s(this.rowsFiltered.length)+"\n          ")]),i._v(" "),s("div",{staticClass:"btn btn-next",attrs:{"data-disabled":i.page*i.perPage>=i.rowsFiltered.length},on:{click:function(t){return i.navigate(1)}}},[s("span",[i._v(i._s(i.$t("next")))]),i._v(" "),s("span",{staticClass:"chevron"})]),i._v(" "),i._t("footer-after-pagination")],2)]:i._e()])],2),i._v(" "),i._t("dialogs")],2)},staticRenderFns:[]},0,{props:{headline:String,columns:Array,rows:Array,options:Object,actions:Object,labels:Object,pagination:{type:[Boolean,Object],default:function(){return{}}},search:{type:[Boolean,Object],default:function(){return{}}},sort:{type:[Boolean,Object],default:function(){return{}}},store:{type:[Boolean,Object],default:function(){return{}}},isLoading:{type:Boolean,default:!1}},data:function(){return{searchTerm:"",sortBy:null,sortOrder:1,page:1,perPage:10}},computed:{config:function(){return Object.assign({actions:Object.assign({inline:!1,items:[],onRow:!1},this.actions),labels:Object.assign({all:"All",empty:"No rows available",perPage:"Rows displayed",reset:"Reset",filter:"Filter items..."},this.labels),pagination:Object.assign({enabled:!0,page:1,perPage:10,perPageOptions:[5,10,25,50,100]},this.resolveOptions(this.pagination)),search:Object.assign({enabled:!0},this.resolveOptions(this.search)),sort:Object.assign({enabled:!0,initialBy:null},this.resolveOptions(this.sort)),store:Object.assign({enabled:!1,name:""},this.resolveOptions(this.store)),add:!1},this.options)},pageOffset:function(){return(this.page-1)*this.perPage},pageRowFirst:function(){return this.pageOffset+1},pageRowLast:function(){return this.pageOffset+this.perPage},rowsFiltered:function(){var i=this;if(""===this.searchTerm)return this.rows;var s=this.searchTerm.toLowerCase();return this.rows.slice().filter(function(n){var o=!1;return Object.keys(n).forEach(function(e){var t=i.columns.find(function(t){return t.field===e});t&&!1!==t.search&&String(n[e]).toLowerCase().includes(s)&&(o=!0)}),o})},rowsPaginated:function(){return this.rowsSorted.slice(this.pageOffset,this.pageOffset+this.perPage)},rowsSorted:function(){var n=this;return this.sortBy&&!1!==this.config.sort.enabled?this.rowsFiltered.slice().sort(function(t,e){if(n.sortBy.field&&(t=t[n.sortBy.field],e=e[n.sortBy.field]),n.sortBy.sort&&n.sortBy.sort.field&&(t=t[n.sortBy.sort.field],e=e[n.sortBy.sort.field]),n.sortBy.sort&&n.sortBy.sort.value&&(t=t[n.sortBy.sort.value],e=e[n.sortBy.sort.value]),n.sortBy.callback)return n.sortBy.callback(t,e,n.sortOrder,n.sortBy);switch(n.sortBy.type){case"number":return(t-e)*n.sortOrder;case"date":return(new Date(t)-new Date(e))*n.sortOrder;default:return t=(""+t).toLowerCase(),e=(""+e).toLowerCase(),t.localeCompare(e)*n.sortOrder}}):this.rowsFiltered},showActions:function(){return!!this.$scopedSlots["column-$actions"]||!!this.config.actions.items&&0<this.config.actions.items.length},showAdd:function(){return this.config.add},showReset:function(){return""!==this.searchTerm||null!==this.sortBy},showSearch:function(){return 0<this.columns.filter(function(t){return!1!==t.search}).length&&this.config.search.enabled},storeName:function(){return"kirby$plugin$tbl$"+this.config.store.name},widthActions:function(){return this.config.actions.width?this.config.actions.width:(this.config.actions.inline?this.config.actions.items.length:1)+"fr"},widthLoading:function(){return Math.max(this.columns.length,1)+(this.showActions?1:0)}},watch:{config:function(){this.load()},searchTerm:function(t){this.setStore(),this.$emit("onFilter",t)}},created:function(){this.load()},methods:{getAlign:function(t){if(t.align)return t.align;switch(t.type){case"number":case"decimal":case"percentage":case"boolean":case"date":return"right";default:return"left"}},getValue:function(t,e){if(!t)return"â€“";switch(e){case"date":return new Date(t).toLocaleString(this.$user.language,{year:"numeric",month:"long",day:"numeric"});case"number":return 1*t;case"decimals":return Number(t).toFixed(2);case"percentage":return Number(100*t).toFixed(2)+"%";default:return t}},load:function(){this.page=this.config.pagination.page,this.perPage=this.config.pagination.perPage,this.loadStore(),this.loadSort()},loadSort:function(){if(!0===this.config.sort.enabled&&null===this.sortBy){var e=this.config.sort.initialBy;if(e){var t=this.columns.find(function(t){return t.name===e});t||(t=this.columns.find(function(t){return t.field===e})),this.setSort(t)}}},loadStore:function(){if(!0===this.config.store.enabled){var t=JSON.parse(sessionStorage.getItem(this.storeName));null!==t&&(this.page=t.page,this.perPage=t.perPage,this.searchTerm=t.searchTerm,this.sortBy=t.sortBy,this.sortOrder=t.sortOrder),this.$emit("onLoadStore",t)}},navigate:function(t){this.page+=t,this.setStore(),this.$emit("onPage",this.page)},onPerPage:function(){this.page=1,this.setStore(),this.$emit("onPerPage",this.perPage)},reset:function(){Object.assign(this.$data,this.$options.data.apply(this)),this.$refs.search.blur(),this.setStore(),this.$emit("onReset")},resolveOptions:function(t){return 0===Object.keys(t).length?t:e(t)==e(!0)?{enabled:t}:Object.assign({enabled:!0},t)},setSort:function(t){!1!==this.config.sort.enabled&&!1!==t.sort&&(this.sortBy===t?this.sortOrder*=-1:(this.sortBy=t,this.sortOrder="desc"===(t.sort&&t.sort.order?t.sort.order:t.sort)?-1:1),this.setStore(),this.$emit("onSort",Object.assign({},t,{currentDirection:this.sortOrder})))},setStore:function(){var e=this;!0===this.config.store.enabled&&this.$nextTick(function(){var t={page:e.page,perPage:e.perPage,searchTerm:e.searchTerm,sortBy:e.sortBy,sortOrder:e.sortOrder};sessionStorage.setItem(e.storeName,JSON.stringify(t)),e.$emit("onLoadStore",t)})}}},0,0,0,void 0,void 0)},"object"==typeof n&&void 0!==e?e.exports=i():"function"==typeof define&&define.amd?define(i):(o=o||self).Tbl=i()},{}],2:[function(o,t,i){!function(){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var t,e=o(1),n=(t=e)&&t.__esModule?t:{default:t};i.default={extends:"k-pages-section",components:{Tbl:n.default},data:function(){return{rows:[],columns:[],isLoading:!1,options:{empty:null,headline:null,layout:"list",link:null,max:null,min:null,size:null,sortable:null,limit:10,limitOptions:[],search:!0}}},props:{parent:String,blueprint:String,name:String},computed:{table:function(){return{actions:{width:"2fr"},pagination:{perPage:this.options.limit,perPageOptions:this.options.limitOptions},labels:{perPage:this.$t("pagetable.rowsPerPage"),of:this.$t("pagetable.of"),all:this.$t("pagetable.all"),empty:this.$t("pages.empty"),filter:this.$t("pagetable.filter-pages"),reset:this.$t("pagetable.reset")},store:{enabled:!0,name:this.parent+"-"+this.name},options:{add:!1}}}},watch:{language:function(){this.reload()}},created:function(){this.load()},methods:{load:function(t){var e=this;t||(this.isLoading=!0),this.$api.get(this.parent+"/sections/"+this.name).then(function(t){e.isLoading=!1,e.options=t.options,e.columns=t.data.columns,e.rows=e.items(t.data.rows)}).catch(function(t){e.isLoading=!1,e.error=t.message})}}}}(),t.exports.__esModule&&(t.exports=t.exports.default);var e="function"==typeof t.exports?t.exports.options:t.exports;e.render=function(){var n=this,t=n.$createElement,o=n._self._c||t;return o("tbl",n._b({attrs:{rows:n.rows,columns:n.columns,isLoading:n.isLoading},scopedSlots:n._u([{key:"column-image",fn:function(t){return[o("k-link",{attrs:{to:t.row.link}},[o("figure",{staticClass:"k-list-item-image"},[t.row.image&&t.row.image.url?o("k-image",{attrs:{src:t.row.image.url,back:t.row.image.back||"pattern",cover:t.row.image.cover}}):o("k-icon",n._b({},"k-icon",t.row.icon,!1))],1)])]}},{key:"column-$default",fn:function(t){return[o("p",[o("k-link",{attrs:{to:t.row.link},domProps:{innerHTML:n._s(t.value)}})],1)]}},{key:"column-$actions",fn:function(e){return[e.row.flag?o("k-button",n._b({on:{click:e.row.flag.click}},"k-button",e.row.flag,!1)):n._e(),n._v(" "),e.row.options?o("k-button",{staticClass:"k-list-item-toggle",attrs:{tooltip:n.$t("options"),icon:"dots",alt:"Options"},on:{click:function(t){t.stopPropagation(),n.$refs["options-"+e.index].toggle()}}}):n._e(),n._v(" "),o("k-dropdown-content",{ref:"options-"+e.index,attrs:{options:e.row.options,align:"right"},on:{action:function(t){n.action(e.row,t)}}})]}}])},"tbl",n.table,!1),[o("template",{slot:"dialogs"},[o("k-page-create-dialog",{ref:"create"}),n._v(" "),o("k-page-rename-dialog",{ref:"rename",on:{success:n.update}}),n._v(" "),o("k-page-url-dialog",{ref:"url",on:{success:n.update}}),n._v(" "),o("k-page-status-dialog",{ref:"status",on:{success:n.update}}),n._v(" "),o("k-page-template-dialog",{ref:"template",on:{success:n.update}}),n._v(" "),o("k-page-remove-dialog",{ref:"remove",on:{success:n.update}})],1)],2)},e.staticRenderFns=[]},{1:1}],3:[function(t,e,n){"use strict";var o,i=t(2),s=(o=i)&&o.__esModule?o:{default:o};panel.plugin("sylvainjule/pagetable",{sections:{pagetable:s.default}})},{2:2}]},{},[3]);
